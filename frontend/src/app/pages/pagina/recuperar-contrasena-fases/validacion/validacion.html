<div class="relative flex flex-col gap-4 sm:gap-5 w-full h-full bg-white rounded-2xl p-5 sm:p-8 md:p-10 lg:p-12 shadow-xl border border-[#e8f4fc] overflow-hidden">
  <!-- Decoraciones de fondo -->
  <div class="absolute top-0 right-0 w-24 h-24 sm:w-32 sm:h-32 bg-linear-to-bl from-[#1788EF]/10 to-transparent rounded-bl-full"></div>
  <div class="absolute bottom-0 left-0 w-20 h-20 sm:w-28 sm:h-28 bg-linear-to-tr from-[#00A448]/10 to-transparent rounded-tr-full"></div>

  <!-- Header del paso -->
  <div class="relative z-10 flex items-center gap-3">
    <span class="flex h-8 w-8 sm:h-9 sm:w-9 items-center justify-center rounded-full bg-linear-to-br from-[#034D82] to-[#01162E] text-sm sm:text-base font-bold text-white shadow-md">2</span>
    <div>
      <p class="text-base sm:text-lg font-semibold text-gray-800">Validar Cuenta</p>
    </div>
  </div>

  <!-- Información del correo -->
  <div class="relative z-10 text-center sm:text-left">
    <p class="text-sm sm:text-base text-gray-600 leading-relaxed">
      ¡Hemos enviado un correo electrónico con un código de verificación de 6 dígitos a tu dirección
      <strong class="text-gray-800 font-semibold">{{ correoUsuario }}</strong>!
    </p>
    <p class="mt-2 text-xs sm:text-sm text-gray-500 flex items-center justify-center sm:justify-start gap-1">
      <span class="icon-[heroicons-outline--clock] text-base"></span>
      El código caduca en 5 minutos
    </p>
  </div>

  <!-- Formulario de código -->
  <form [formGroup]="pinForm" class="relative z-10 flex flex-col items-center w-full">
    <p class="text-xs sm:text-sm text-gray-500 mb-3 sm:mb-4">Ingresa el código de 6 dígitos</p>
    <div #inputsContainer class="grid grid-cols-6 gap-1 min-[360px]:gap-1.5 min-[400px]:gap-2 sm:gap-3 w-full max-w-[280px] min-[360px]:max-w-[300px] min-[400px]:max-w-[340px] sm:max-w-sm mx-auto" (paste)="onPaste($event)">
      <input
        *ngFor="let ctrl of pinControls; let i = index"
        maxlength="1"
        type="text"
        inputmode="numeric"
        pattern="[0-9]*"
        formControlName="{{ 'digit' + i }}"
        appSoloNumeros
        [maxDigitos]="1"
        (input)="onInput($event, i)"
        (keydown)="onKeyDown($event, i)"
        class="aspect-square w-full max-w-10 min-[360px]:max-w-11 min-[400px]:max-w-12 sm:max-w-14 rounded-lg sm:rounded-xl border-2 border-gray-200 bg-gray-50/50 text-center text-sm min-[360px]:text-base min-[400px]:text-lg sm:text-xl md:text-2xl font-semibold text-gray-800
        transition-all duration-200 focus:bg-white focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 focus:outline-none"
      />
    </div>
  </form>

  <!-- Botón Verificar -->
  <button
    (click)="verificarCodigo()"
    class="relative z-10 btn btn-block btn-sm sm:btn-md bg-blue-600 border-blue-600 text-white font-semibold rounded-xl
    shadow-lg shadow-blue-600/25 hover:bg-blue-700 hover:border-blue-700 hover:shadow-blue-700/30
    transition-all duration-200 disabled:opacity-70 disabled:cursor-not-allowed mt-2"
    [disabled]="isLoading"
  >
    @if (isLoading) {
    <span class="loading loading-spinner loading-xs sm:loading-sm"></span>
    <span class="text-xs sm:text-sm">Verificando...</span>
    } @else {
    <span class="text-xs sm:text-sm">Verificar código</span>
    <span class="icon-[heroicons-outline--check-circle] text-base sm:text-lg"></span>
    }
  </button>

  <!-- Botones secundarios -->
  <div class="relative z-10 flex flex-col sm:flex-row justify-center gap-3 sm:gap-4 mt-2">
    <button
      class="btn btn-sm sm:btn-md border-2 border-gray-300 bg-transparent text-gray-700 font-medium rounded-xl
      hover:bg-gray-100 hover:border-gray-400 transition-all duration-200 disabled:opacity-70
      w-full sm:w-auto sm:min-w-[140px]"
      (click)="emitirVolver()"
      [disabled]="isLoading"
    >
      <span class="icon-[heroicons-outline--arrow-left] text-base sm:text-lg"></span>
      <span class="text-xs sm:text-sm">Volver</span>
    </button>
    <button
      class="btn btn-sm sm:btn-md border-2 border-[#034D82]/60 bg-transparent text-[#034D82] font-medium rounded-xl
      hover:bg-[#034D82]/10 hover:border-[#034D82] transition-all duration-200 disabled:opacity-70
      w-full sm:w-auto sm:min-w-[160px]"
      (click)="reenviarCodigo()"
      [disabled]="isResending || isLoading || cooldownSeconds > 0"
    >
      @if (isResending) {
      <span class="loading loading-spinner loading-xs sm:loading-sm"></span>
      <span class="text-xs sm:text-sm">Reenviando...</span>
      } @else if (cooldownSeconds > 0) {
      <span class="icon-[heroicons-outline--clock] text-base sm:text-lg"></span>
      <span class="text-xs sm:text-sm">Espera {{ cooldownSeconds }}s</span>
      } @else {
      <span class="icon-[heroicons-outline--arrow-path] text-base sm:text-lg"></span>
      <span class="text-xs sm:text-sm">Reenviar código</span>
      }
    </button>
  </div>
</div>
